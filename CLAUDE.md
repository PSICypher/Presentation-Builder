# Presentation Builder - Project Context

> **Recovery**: Run `gt prime` after compaction, clear, or new session

## Mission

Build a **repeatable, data-driven presentation generation tool**. Given a set of data files (CSV, Excel) and a PowerPoint template or example, produce a formatted, accurate presentation.

This project was born from the QBR (Quarterly Business Review) automation work done in the CoWork project. That work proved the concept but was manual and one-off. This rig industrialises it.

## Reference Material

**All prior art and learnings live in the CoWork project:**
```
/Users/merwes/CLAUDE/CoWork/QBRs/
```

Key files to study:
- `Vision.md` — Project philosophy, lessons learned, what works and what doesn't
- `ingenuity-qbr/SKILL.md` — The starting skill (workflow, design guidelines, data formats)
- `ingenuity-qbr/references/` — Detailed specs for sections, channels, data formats, process
- `ingenuity-qbr/assets/qbr-template.pptx` — Example PowerPoint template
- `*_ATTEMPT1.pptx` / `*_ATTEMPT2.pptx` — Failed/improved iterations (study the evolution)
- `No7/FY26/Int. Performance Tracker/` — Example data source (Excel trackers)
- Supplementary data: `CRM No7 US Q4.xlsm`, `Affiliate Publisher Q4 No7 US.xlsm`, `Offer Performance No7 US Q4.csv`, `Product Sales Report No7 US Q4.csv`

## Architecture

This project has three layers:

### 1. Template Analyzer
Reads a PowerPoint file and extracts its structure:
- Slide layouts, master slides, colour palette
- Font families, sizes, styling rules
- Placeholder positions and types
- Chart types and data bindings
- Image positions and sizing
- Produces a machine-readable **template schema** (JSON/YAML)

### 2. Data Processor
Reads raw data files and prepares them for presentation:
- Ingests CSV, Excel (.xlsx, .xlsm) files
- Normalises column names and data types
- Calculates derived metrics (YoY variance, COS, ROAS, CVR, etc.)
- Identifies the narrative (growth? decline? mixed?)
- Maps data fields to template schema slots
- Produces a **data payload** (JSON) ready for slide population

### 3. Presentation Generator
Combines template schema + data payload to produce output:
- Uses `python-pptx` to create/modify PowerPoint files
- Preserves original template formatting exactly
- Populates data into correct positions
- Generates charts from data
- Handles conditional slides (include/exclude based on data availability)
- Runs QA checks (no placeholder text, no stale data, similarity < 80% vs previous)

## Core Principles (from CoWork lessons)

1. **Data-first** — Extract and analyse data BEFORE writing narrative
2. **No recycling** — Each output must reflect its own data, not copy-paste
3. **Honest gaps** — Missing data = "N/A", never fabricated
4. **Template-driven** — Output formatting comes from the template, not hardcoded
5. **Similarity checking** — Compare output to previous runs, target < 80% similarity

## Tech Stack

- **Python 3.11+**
- `python-pptx` — PowerPoint manipulation
- `pandas` — Data processing
- `openpyxl` — Excel reading
- `markitdown` — PPTX-to-text for QA
- `Pillow` — Thumbnail generation for visual QA
- `pyyaml` — Schema/config files

## Project Structure

```
/
├── CLAUDE.md                    ← This file
├── requirements.txt             ← Python dependencies
├── src/
│   ├── analyzer/                ← Template analysis engine
│   │   ├── __init__.py
│   │   ├── extract.py           ← Extract template structure
│   │   └── schema.py            ← Template schema model
│   ├── processor/               ← Data processing pipeline
│   │   ├── __init__.py
│   │   ├── ingest.py            ← Read CSV/Excel files
│   │   ├── transform.py         ← Calculate derived metrics
│   │   └── mapper.py            ← Map data to template slots
│   ├── generator/               ← Presentation output
│   │   ├── __init__.py
│   │   ├── builder.py           ← Build PPTX from schema + data
│   │   ├── charts.py            ← Chart generation
│   │   └── qa.py                ← Quality assurance checks
│   └── cli.py                   ← Command-line entry point
├── templates/                   ← Template schemas (generated by analyzer)
├── data/                        ← Sample/test data
├── output/                      ← Generated presentations
└── tests/
    ├── test_analyzer.py
    ├── test_processor.py
    └── test_generator.py
```
